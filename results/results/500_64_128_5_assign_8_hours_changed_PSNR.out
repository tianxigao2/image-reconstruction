+ cd /pylon5/ac5610p/janegao/image-reconstruction-2019/code/
+ python main.py
2019-06-25 09:54:42.798099: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-06-25 09:54:42.816108: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294635000 Hz
2019-06-25 09:54:42.825749: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x555e3a59eed0 executing computations on platform Host. Devices:
2019-06-25 09:54:42.825862: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-27
OMP: Info #156: KMP_AFFINITY: 28 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 2 packages x 14 cores/pkg x 1 threads/core (28 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 14 maps to package 0 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 15 maps to package 0 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 17 maps to package 0 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 18 maps to package 0 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 19 maps to package 0 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 0 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 1 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 21 maps to package 1 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 1 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 22 maps to package 1 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 9 maps to package 1 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 23 maps to package 1 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 1 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 24 maps to package 1 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 11 maps to package 1 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 25 maps to package 1 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 1 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 26 maps to package 1 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 13 maps to package 1 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 27 maps to package 1 core 14 
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6658 thread 0 bound to OS proc set 0
2019-06-25 09:54:42.828668: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Using TensorFlow backend.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6927 thread 1 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6973 thread 2 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6975 thread 4 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6974 thread 3 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6976 thread 5 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6977 thread 6 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6978 thread 7 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6980 thread 9 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6979 thread 8 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6981 thread 10 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6982 thread 11 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6983 thread 12 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6984 thread 13 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6985 thread 14 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6986 thread 15 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6987 thread 16 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6988 thread 17 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6989 thread 18 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6990 thread 19 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6991 thread 20 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6992 thread 21 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6993 thread 22 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6994 thread 23 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6995 thread 24 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6996 thread 25 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6997 thread 26 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6998 thread 27 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6999 thread 28 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 6928 thread 29 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7000 thread 30 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7001 thread 31 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7002 thread 32 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7003 thread 33 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7004 thread 34 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7005 thread 35 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7006 thread 36 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7007 thread 37 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7008 thread 38 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7009 thread 39 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7010 thread 40 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7011 thread 41 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7012 thread 42 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7013 thread 43 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7014 thread 44 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7015 thread 45 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7016 thread 46 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7017 thread 47 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7018 thread 48 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7019 thread 49 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7020 thread 50 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7021 thread 51 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7022 thread 52 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7023 thread 53 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7024 thread 54 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7025 thread 55 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 6658 tid 7026 thread 56 bound to OS proc set 0
index for selecting frames
range(0, 2000, 4)
index for selecting frames
range(0, 2000, 4)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 128, 128, 64)      5248      
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 128, 32)      2080      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 128, 128, 1)       801       
=================================================================
Total params: 8,129
Trainable params: 8,129
Non-trainable params: 0
_________________________________________________________________
None
Train on 320 samples, validate on 80 samples
Epoch 1/1000
 - 29s - loss: 833.8425 - ssim_for2d: 0.7856 - psnr_for2d: 19.5533 - val_loss: 490.8263 - val_ssim_for2d: 0.8785 - val_psnr_for2d: 21.2218
Epoch 2/1000
 - 27s - loss: 416.4611 - ssim_for2d: 0.8902 - psnr_for2d: 21.9479 - val_loss: 404.4213 - val_ssim_for2d: 0.8896 - val_psnr_for2d: 22.0643
Epoch 3/1000
 - 28s - loss: 332.3642 - ssim_for2d: 0.8993 - psnr_for2d: 22.9279 - val_loss: 350.2371 - val_ssim_for2d: 0.8948 - val_psnr_for2d: 22.6925
Epoch 4/1000
 - 28s - loss: 272.6507 - ssim_for2d: 0.9054 - psnr_for2d: 23.7899 - val_loss: 316.0780 - val_ssim_for2d: 0.8975 - val_psnr_for2d: 23.1430
Epoch 5/1000
 - 28s - loss: 232.7496 - ssim_for2d: 0.9087 - psnr_for2d: 24.4813 - val_loss: 290.5474 - val_ssim_for2d: 0.8992 - val_psnr_for2d: 23.5154
Epoch 6/1000
 - 27s - loss: 208.2495 - ssim_for2d: 0.9113 - psnr_for2d: 24.9678 - val_loss: 289.6039 - val_ssim_for2d: 0.8990 - val_psnr_for2d: 23.5332
Epoch 7/1000
 - 27s - loss: 192.0857 - ssim_for2d: 0.9141 - psnr_for2d: 25.3242 - val_loss: 270.5113 - val_ssim_for2d: 0.9021 - val_psnr_for2d: 23.8366
Epoch 8/1000
 - 27s - loss: 178.8175 - ssim_for2d: 0.9164 - psnr_for2d: 25.6379 - val_loss: 258.6676 - val_ssim_for2d: 0.9045 - val_psnr_for2d: 24.0356
Epoch 9/1000
 - 27s - loss: 168.0844 - ssim_for2d: 0.9184 - psnr_for2d: 25.9094 - val_loss: 252.8183 - val_ssim_for2d: 0.9055 - val_psnr_for2d: 24.1409
Epoch 10/1000
 - 27s - loss: 159.8042 - ssim_for2d: 0.9200 - psnr_for2d: 26.1301 - val_loss: 249.4941 - val_ssim_for2d: 0.9060 - val_psnr_for2d: 24.2027
Epoch 11/1000
 - 28s - loss: 151.5058 - ssim_for2d: 0.9217 - psnr_for2d: 26.3647 - val_loss: 242.1410 - val_ssim_for2d: 0.9070 - val_psnr_for2d: 24.3386
Epoch 12/1000
 - 27s - loss: 144.7972 - ssim_for2d: 0.9232 - psnr_for2d: 26.5633 - val_loss: 233.6776 - val_ssim_for2d: 0.9093 - val_psnr_for2d: 24.4938
Epoch 13/1000
 - 27s - loss: 138.5697 - ssim_for2d: 0.9247 - psnr_for2d: 26.7563 - val_loss: 230.6008 - val_ssim_for2d: 0.9091 - val_psnr_for2d: 24.5552
Epoch 14/1000
 - 28s - loss: 133.0736 - ssim_for2d: 0.9259 - psnr_for2d: 26.9353 - val_loss: 222.6705 - val_ssim_for2d: 0.9095 - val_psnr_for2d: 24.7117
Epoch 15/1000
 - 27s - loss: 127.5664 - ssim_for2d: 0.9273 - psnr_for2d: 27.1204 - val_loss: 229.2142 - val_ssim_for2d: 0.9094 - val_psnr_for2d: 24.5824
Epoch 16/1000
 - 27s - loss: 123.3829 - ssim_for2d: 0.9284 - psnr_for2d: 27.2697 - val_loss: 217.1768 - val_ssim_for2d: 0.9112 - val_psnr_for2d: 24.8262
Epoch 17/1000
 - 28s - loss: 118.3830 - ssim_for2d: 0.9298 - psnr_for2d: 27.4517 - val_loss: 221.9823 - val_ssim_for2d: 0.9105 - val_psnr_for2d: 24.7307
Epoch 18/1000
 - 27s - loss: 114.9082 - ssim_for2d: 0.9307 - psnr_for2d: 27.5812 - val_loss: 201.7506 - val_ssim_for2d: 0.9129 - val_psnr_for2d: 25.1589
Epoch 19/1000
 - 27s - loss: 111.5977 - ssim_for2d: 0.9314 - psnr_for2d: 27.7127 - val_loss: 206.5380 - val_ssim_for2d: 0.9131 - val_psnr_for2d: 25.0557
Epoch 20/1000
 - 27s - loss: 108.3286 - ssim_for2d: 0.9324 - psnr_for2d: 27.8429 - val_loss: 209.4156 - val_ssim_for2d: 0.9126 - val_psnr_for2d: 24.9983
Epoch 21/1000
 - 27s - loss: 105.4760 - ssim_for2d: 0.9331 - psnr_for2d: 27.9590 - val_loss: 208.9254 - val_ssim_for2d: 0.9128 - val_psnr_for2d: 25.0072
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
 
batch, amount, resolution: 5 500 64 -> 128
without processed by neural network:
psnr =  20.26266496181488
ssim =  0.8795055717229843
performance after processed by nerual network:
psnr:  27.4389013671875
ssim:  0.9293122792243957
performance of predicted images:
psnr, ssim for raw data: 20.2119718170166 0.8704641950130463
psnr, ssim for predicted result: 17.83778091430664 0.8349010509252548
mae, mse for raw data: 62.7815234375 16.413831787109373
mae, mse for predicted result 4.681841177940369 318.9909320068359
