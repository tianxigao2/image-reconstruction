+ cd /pylon5/ac5610p/janegao/image-reconstruction-2019/code/code_3d/
+ python main_3d.py
2019-06-26 16:31:11.346422: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-06-26 16:31:11.363371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294750000 Hz
2019-06-26 16:31:11.371913: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5595201af330 executing computations on platform Host. Devices:
2019-06-26 16:31:11.372005: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-27
OMP: Info #156: KMP_AFFINITY: 28 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 2 packages x 14 cores/pkg x 1 threads/core (28 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 14 maps to package 0 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 15 maps to package 0 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 17 maps to package 0 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 18 maps to package 0 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 19 maps to package 0 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 0 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 1 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 21 maps to package 1 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 1 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 22 maps to package 1 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 9 maps to package 1 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 23 maps to package 1 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 1 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 24 maps to package 1 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 11 maps to package 1 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 25 maps to package 1 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 1 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 26 maps to package 1 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 13 maps to package 1 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 27 maps to package 1 core 14 
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7454 thread 0 bound to OS proc set 0
2019-06-26 16:31:11.374895: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Using TensorFlow backend.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7539 thread 1 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7583 thread 2 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7584 thread 3 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7585 thread 4 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7586 thread 5 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7587 thread 6 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7588 thread 7 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7590 thread 9 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7589 thread 8 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7591 thread 10 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7592 thread 11 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7593 thread 12 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7594 thread 13 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7595 thread 14 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7596 thread 15 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7597 thread 16 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7598 thread 17 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7599 thread 18 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7600 thread 19 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7601 thread 20 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7602 thread 21 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7603 thread 22 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7604 thread 23 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7605 thread 24 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7606 thread 25 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7607 thread 26 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7608 thread 27 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7609 thread 28 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7538 thread 29 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7611 thread 31 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7610 thread 30 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7612 thread 32 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7613 thread 33 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7614 thread 34 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7615 thread 35 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7616 thread 36 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7617 thread 37 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7618 thread 38 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7619 thread 39 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7620 thread 40 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7621 thread 41 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7623 thread 43 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7622 thread 42 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7624 thread 44 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7625 thread 45 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7626 thread 46 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7627 thread 47 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7628 thread 48 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7629 thread 49 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7630 thread 50 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7631 thread 51 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7632 thread 52 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7633 thread 53 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7634 thread 54 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7635 thread 55 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 7454 tid 7636 thread 56 bound to OS proc set 0
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv3d_1 (Conv3D)            (None, 5, 64, 64, 32)     896       
_________________________________________________________________
conv3d_2 (Conv3D)            (None, 5, 64, 64, 32)     27680     
_________________________________________________________________
conv3d_3 (Conv3D)            (None, 5, 64, 64, 32)     27680     
_________________________________________________________________
conv3d_4 (Conv3D)            (None, 3, 62, 62, 32)     27680     
_________________________________________________________________
conv3d_5 (Conv3D)            (None, 1, 60, 60, 32)     27680     
_________________________________________________________________
reshape_1 (Reshape)          (None, 60, 60, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 60, 60, 1)         289       
=================================================================
Total params: 111,905
Trainable params: 111,905
Non-trainable params: 0
_________________________________________________________________
None
shape of train_x (79, 5, 64, 64, 1) shape of train_y (79, 60, 60, 1)
Train on 63 samples, validate on 16 samples
Epoch 1/1000
 - 5s - loss: 2234.3730 - ssim_for2d: 0.2666 - psnr_for2d: -3.3328e+01 - val_loss: 1687.1950 - val_ssim_for2d: 0.3682 - val_psnr_for2d: -3.2271e+01
Epoch 2/1000
 - 4s - loss: 1554.1101 - ssim_for2d: 0.4540 - psnr_for2d: -3.1905e+01 - val_loss: 1329.8446 - val_ssim_for2d: 0.5044 - val_psnr_for2d: -3.1238e+01
Epoch 3/1000
 - 4s - loss: 1223.7533 - ssim_for2d: 0.5445 - psnr_for2d: -3.0859e+01 - val_loss: 963.4712 - val_ssim_for2d: 0.5630 - val_psnr_for2d: -2.9838e+01
Epoch 4/1000
 - 4s - loss: 822.9612 - ssim_for2d: 0.6025 - psnr_for2d: -2.9118e+01 - val_loss: 627.8958 - val_ssim_for2d: 0.6350 - val_psnr_for2d: -2.7979e+01
Epoch 5/1000
 - 4s - loss: 545.6290 - ssim_for2d: 0.6690 - psnr_for2d: -2.7346e+01 - val_loss: 497.4324 - val_ssim_for2d: 0.6693 - val_psnr_for2d: -2.6965e+01
Epoch 6/1000
 - 4s - loss: 398.1878 - ssim_for2d: 0.7091 - psnr_for2d: -2.5971e+01 - val_loss: 414.6537 - val_ssim_for2d: 0.7022 - val_psnr_for2d: -2.6169e+01
Epoch 7/1000
 - 4s - loss: 306.6375 - ssim_for2d: 0.7457 - psnr_for2d: -2.4833e+01 - val_loss: 346.4050 - val_ssim_for2d: 0.7208 - val_psnr_for2d: -2.5389e+01
Epoch 8/1000
 - 4s - loss: 247.5632 - ssim_for2d: 0.7724 - psnr_for2d: -2.3878e+01 - val_loss: 320.7029 - val_ssim_for2d: 0.7370 - val_psnr_for2d: -2.5046e+01
Epoch 9/1000
 - 4s - loss: 204.8694 - ssim_for2d: 0.7908 - psnr_for2d: -2.3037e+01 - val_loss: 315.2076 - val_ssim_for2d: 0.7460 - val_psnr_for2d: -2.4962e+01
Epoch 10/1000
 - 4s - loss: 189.5644 - ssim_for2d: 0.7998 - psnr_for2d: -2.2678e+01 - val_loss: 284.0919 - val_ssim_for2d: 0.7466 - val_psnr_for2d: -2.4518e+01
Epoch 11/1000
 - 4s - loss: 167.7713 - ssim_for2d: 0.8098 - psnr_for2d: -2.2136e+01 - val_loss: 285.6528 - val_ssim_for2d: 0.7540 - val_psnr_for2d: -2.4541e+01
Epoch 12/1000
 - 4s - loss: 165.6432 - ssim_for2d: 0.8145 - psnr_for2d: -2.2053e+01 - val_loss: 272.2218 - val_ssim_for2d: 0.7509 - val_psnr_for2d: -2.4332e+01
Epoch 13/1000
 - 4s - loss: 157.6400 - ssim_for2d: 0.8184 - psnr_for2d: -2.1872e+01 - val_loss: 292.2526 - val_ssim_for2d: 0.7514 - val_psnr_for2d: -2.4644e+01
Epoch 14/1000
 - 4s - loss: 138.5328 - ssim_for2d: 0.8253 - psnr_for2d: -2.1258e+01 - val_loss: 250.8894 - val_ssim_for2d: 0.7665 - val_psnr_for2d: -2.3973e+01
Epoch 15/1000
 - 4s - loss: 125.7628 - ssim_for2d: 0.8279 - psnr_for2d: -2.0813e+01 - val_loss: 227.1690 - val_ssim_for2d: 0.7674 - val_psnr_for2d: -2.3535e+01
Epoch 16/1000
 - 4s - loss: 118.9774 - ssim_for2d: 0.8309 - psnr_for2d: -2.0584e+01 - val_loss: 230.6379 - val_ssim_for2d: 0.7752 - val_psnr_for2d: -2.3600e+01
Epoch 17/1000
 - 4s - loss: 114.5403 - ssim_for2d: 0.8365 - psnr_for2d: -2.0393e+01 - val_loss: 220.3814 - val_ssim_for2d: 0.7779 - val_psnr_for2d: -2.3388e+01
Epoch 18/1000
 - 4s - loss: 111.1639 - ssim_for2d: 0.8389 - psnr_for2d: -2.0284e+01 - val_loss: 227.1135 - val_ssim_for2d: 0.7783 - val_psnr_for2d: -2.3523e+01
Epoch 19/1000
 - 4s - loss: 111.1928 - ssim_for2d: 0.8433 - psnr_for2d: -2.0297e+01 - val_loss: 232.4163 - val_ssim_for2d: 0.7803 - val_psnr_for2d: -2.3629e+01
Epoch 20/1000
 - 4s - loss: 103.3010 - ssim_for2d: 0.8456 - psnr_for2d: -1.9965e+01 - val_loss: 241.3629 - val_ssim_for2d: 0.7781 - val_psnr_for2d: -2.3781e+01
Epoch 00020: early stopping
 
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
type(test_predictions:  <class 'numpy.ndarray'>
test_predictions.shape:  (20, 60, 60, 1)
after model.fit, train_x and train_y shape: (79, 5, 64, 64, 1) (79, 60, 60, 1)
shape pf test_x (20, 5, 64, 64, 1) shape of test_y (20, 60, 60, 1)
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
()
AMOUNT, BATCH, TARGET_HEIGHT: AMOUNT, BATCH, TARGET_HEIGHT
without processed by neural network:
psnr =  -32.60449865799916
ssim =  0.47538809497145157
performance after processed by nerual network:
psnr:  -20.619969452483744
ssim:  0.8299944483781163
performance of predicted images:
psnr, ssim for raw data: -32.103548526763916 0.4768182381987572
psnr, ssim for predicted result: -26.778673553466795 0.7193692117929459
mae, mse for raw data: 13.245124999999998 1623.6680694444444
mae, mse for predicted result 6.3124185562133786 485.96231842041016
