+ cd /pylon5/ac5610p/janegao/image-reconstruction-2019/code/code_2d/
+ python main.py
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-31
OMP: Info #156: KMP_AFFINITY: 32 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 2 packages x 16 cores/pkg x 1 threads/core (32 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 17 maps to package 0 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 18 maps to package 0 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 19 maps to package 0 core 7 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 0 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 21 maps to package 0 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 22 maps to package 0 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 0 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 23 maps to package 0 core 15 
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 1 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 24 maps to package 1 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 9 maps to package 1 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 25 maps to package 1 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 1 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 26 maps to package 1 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 11 maps to package 1 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 27 maps to package 1 core 7 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 1 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 28 maps to package 1 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 13 maps to package 1 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 29 maps to package 1 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 14 maps to package 1 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 30 maps to package 1 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 15 maps to package 1 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 31 maps to package 1 core 15 
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 9976 thread 0 bound to OS proc set 0
2019-06-28 12:10:22.234359: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-06-28 12:10:22.239672: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2095155000 Hz
2019-06-28 12:10:22.239859: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x555cf475ae30 executing computations on platform Host. Devices:
2019-06-28 12:10:22.239897: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-28 12:10:22.240010: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Using TensorFlow backend.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 9999 thread 1 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10076 thread 3 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10073 thread 2 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10077 thread 4 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10078 thread 5 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10079 thread 6 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10080 thread 7 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10081 thread 8 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10083 thread 10 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10082 thread 9 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10084 thread 11 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10086 thread 12 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10087 thread 13 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10088 thread 14 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10089 thread 15 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10090 thread 16 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10091 thread 17 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10092 thread 18 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10093 thread 19 bound to OS proc set 28
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10094 thread 20 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10095 thread 21 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10096 thread 22 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10098 thread 23 bound to OS proc set 29
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10099 thread 24 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10100 thread 25 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10101 thread 26 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10103 thread 28 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10102 thread 27 bound to OS proc set 30
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10104 thread 29 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10105 thread 30 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10106 thread 31 bound to OS proc set 31
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10107 thread 32 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 9998 thread 33 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10108 thread 34 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10109 thread 35 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10110 thread 36 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10111 thread 37 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10112 thread 38 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10113 thread 39 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10114 thread 40 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10115 thread 41 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10116 thread 42 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10117 thread 43 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10118 thread 44 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10119 thread 45 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10120 thread 46 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10121 thread 47 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10122 thread 48 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10123 thread 49 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10124 thread 50 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10125 thread 51 bound to OS proc set 28
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10126 thread 52 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10127 thread 53 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10128 thread 54 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10129 thread 55 bound to OS proc set 29
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10130 thread 56 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10131 thread 57 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10132 thread 58 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10133 thread 59 bound to OS proc set 30
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10134 thread 60 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10135 thread 61 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10136 thread 62 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10137 thread 63 bound to OS proc set 31
OMP: Info #250: KMP_AFFINITY: pid 9976 tid 10138 thread 64 bound to OS proc set 0
loading the whole csv file (3288, 64, 64, 1)
loading the whole csv file (3288, 64, 64, 1)
shape before reshape (3288, 1, 64, 64)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 64, 64, 64)        5248      
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 64, 32)        2080      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 64, 1)         801       
=================================================================
Total params: 8,129
Trainable params: 8,129
Non-trainable params: 0
_________________________________________________________________
None
Train on 2104 samples, validate on 526 samples
Epoch 1/1000
 - 44s - loss: 0.0235 - ssim_for2d: 0.6637 - psnr_for2d: 19.5161 - val_loss: 0.0056 - val_ssim_for2d: 0.7774 - val_psnr_for2d: 23.2330
Epoch 2/1000
 - 39s - loss: 0.0034 - ssim_for2d: 0.8136 - psnr_for2d: 25.9249 - val_loss: 0.0022 - val_ssim_for2d: 0.8398 - val_psnr_for2d: 28.0713
Epoch 3/1000
 - 39s - loss: 0.0018 - ssim_for2d: 0.8550 - psnr_for2d: 29.2204 - val_loss: 0.0016 - val_ssim_for2d: 0.8637 - val_psnr_for2d: 29.9002
Epoch 4/1000
 - 39s - loss: 0.0015 - ssim_for2d: 0.8715 - psnr_for2d: 30.4454 - val_loss: 0.0014 - val_ssim_for2d: 0.8760 - val_psnr_for2d: 30.8538
Epoch 5/1000
 - 39s - loss: 0.0013 - ssim_for2d: 0.8815 - psnr_for2d: 31.2233 - val_loss: 0.0013 - val_ssim_for2d: 0.8846 - val_psnr_for2d: 31.4110
Epoch 6/1000
 - 39s - loss: 0.0012 - ssim_for2d: 0.8886 - psnr_for2d: 31.5615 - val_loss: 0.0012 - val_ssim_for2d: 0.8903 - val_psnr_for2d: 31.8493
Epoch 7/1000
 - 40s - loss: 0.0011 - ssim_for2d: 0.8935 - psnr_for2d: 32.0125 - val_loss: 0.0011 - val_ssim_for2d: 0.8947 - val_psnr_for2d: 32.1911
Epoch 8/1000
 - 40s - loss: 0.0011 - ssim_for2d: 0.8972 - psnr_for2d: 32.2373 - val_loss: 0.0011 - val_ssim_for2d: 0.8980 - val_psnr_for2d: 32.4599
Epoch 9/1000
 - 39s - loss: 0.0011 - ssim_for2d: 0.8999 - psnr_for2d: 32.2925 - val_loss: 0.0011 - val_ssim_for2d: 0.9002 - val_psnr_for2d: 32.2932
Epoch 10/1000
 - 39s - loss: 0.0010 - ssim_for2d: 0.9021 - psnr_for2d: 32.3697 - val_loss: 0.0010 - val_ssim_for2d: 0.9024 - val_psnr_for2d: 32.6774
Epoch 11/1000
 - 39s - loss: 9.8492e-04 - ssim_for2d: 0.9039 - psnr_for2d: 32.7919 - val_loss: 0.0010 - val_ssim_for2d: 0.9041 - val_psnr_for2d: 32.9082
Epoch 12/1000
 - 39s - loss: 9.7147e-04 - ssim_for2d: 0.9054 - psnr_for2d: 32.8287 - val_loss: 9.8675e-04 - val_ssim_for2d: 0.9056 - val_psnr_for2d: 32.9705
Epoch 13/1000
 - 39s - loss: 9.5008e-04 - ssim_for2d: 0.9068 - psnr_for2d: 32.9868 - val_loss: 9.7176e-04 - val_ssim_for2d: 0.9071 - val_psnr_for2d: 33.0378
Epoch 14/1000
 - 39s - loss: 9.4068e-04 - ssim_for2d: 0.9081 - psnr_for2d: 32.9945 - val_loss: 9.5314e-04 - val_ssim_for2d: 0.9083 - val_psnr_for2d: 33.1801
Epoch 15/1000
 - 39s - loss: 9.5416e-04 - ssim_for2d: 0.9093 - psnr_for2d: 32.7407 - val_loss: 0.0011 - val_ssim_for2d: 0.9085 - val_psnr_for2d: 31.2245
Epoch 16/1000
 - 39s - loss: 9.4313e-04 - ssim_for2d: 0.9103 - psnr_for2d: 32.8314 - val_loss: 9.3000e-04 - val_ssim_for2d: 0.9104 - val_psnr_for2d: 33.3036
Epoch 17/1000
 - 39s - loss: 9.0040e-04 - ssim_for2d: 0.9113 - psnr_for2d: 33.2842 - val_loss: 9.2025e-04 - val_ssim_for2d: 0.9112 - val_psnr_for2d: 33.3695
Epoch 18/1000
 - 40s - loss: 8.9120e-04 - ssim_for2d: 0.9121 - psnr_for2d: 33.3416 - val_loss: 9.1323e-04 - val_ssim_for2d: 0.9121 - val_psnr_for2d: 33.4057
Epoch 19/1000
 - 39s - loss: 8.8294e-04 - ssim_for2d: 0.9128 - psnr_for2d: 33.3915 - val_loss: 9.0526e-04 - val_ssim_for2d: 0.9129 - val_psnr_for2d: 33.4527
Epoch 20/1000
 - 39s - loss: 8.7805e-04 - ssim_for2d: 0.9135 - psnr_for2d: 33.3958 - val_loss: 8.9648e-04 - val_ssim_for2d: 0.9136 - val_psnr_for2d: 33.5183
Epoch 21/1000
 - 39s - loss: 8.7560e-04 - ssim_for2d: 0.9142 - psnr_for2d: 33.3683 - val_loss: 9.0320e-04 - val_ssim_for2d: 0.9142 - val_psnr_for2d: 33.3366
Epoch 22/1000
 - 39s - loss: 9.6958e-04 - ssim_for2d: 0.9145 - psnr_for2d: 32.4315 - val_loss: 8.9135e-04 - val_ssim_for2d: 0.9146 - val_psnr_for2d: 33.4332
Epoch 23/1000
 - 39s - loss: 8.5800e-04 - ssim_for2d: 0.9153 - psnr_for2d: 33.5372 - val_loss: 8.7861e-04 - val_ssim_for2d: 0.9151 - val_psnr_for2d: 33.6175
Epoch 24/1000
 - 39s - loss: 8.5214e-04 - ssim_for2d: 0.9157 - psnr_for2d: 33.5858 - val_loss: 8.7374e-04 - val_ssim_for2d: 0.9156 - val_psnr_for2d: 33.6605
Epoch 25/1000
 - 39s - loss: 8.4969e-04 - ssim_for2d: 0.9161 - psnr_for2d: 33.5804 - val_loss: 8.6839e-04 - val_ssim_for2d: 0.9160 - val_psnr_for2d: 33.7052
Epoch 26/1000
 - 39s - loss: 8.4302e-04 - ssim_for2d: 0.9165 - psnr_for2d: 33.6476 - val_loss: 8.6757e-04 - val_ssim_for2d: 0.9164 - val_psnr_for2d: 33.6778
Epoch 27/1000
 - 39s - loss: 8.4760e-04 - ssim_for2d: 0.9168 - psnr_for2d: 33.5379 - val_loss: 8.6900e-04 - val_ssim_for2d: 0.9167 - val_psnr_for2d: 33.6126
Epoch 28/1000
 - 39s - loss: 8.3586e-04 - ssim_for2d: 0.9172 - psnr_for2d: 33.6899 - val_loss: 8.5683e-04 - val_ssim_for2d: 0.9170 - val_psnr_for2d: 33.7819
Epoch 29/1000
 - 39s - loss: 9.6265e-04 - ssim_for2d: 0.9170 - psnr_for2d: 32.5069 - val_loss: 9.2947e-04 - val_ssim_for2d: 0.9167 - val_psnr_for2d: 32.6736
Epoch 30/1000
 - 41s - loss: 8.4101e-04 - ssim_for2d: 0.9176 - psnr_for2d: 33.5580 - val_loss: 8.5277e-04 - val_ssim_for2d: 0.9174 - val_psnr_for2d: 33.7888
Epoch 31/1000
 - 39s - loss: 8.2667e-04 - ssim_for2d: 0.9179 - psnr_for2d: 33.7674 - val_loss: 8.4924e-04 - val_ssim_for2d: 0.9176 - val_psnr_for2d: 33.8286
Epoch 32/1000
 - 39s - loss: 8.2499e-04 - ssim_for2d: 0.9181 - psnr_for2d: 33.7687 - val_loss: 8.4653e-04 - val_ssim_for2d: 0.9178 - val_psnr_for2d: 33.8616
Epoch 33/1000
 - 39s - loss: 8.2354e-04 - ssim_for2d: 0.9182 - psnr_for2d: 33.7706 - val_loss: 8.4439e-04 - val_ssim_for2d: 0.9180 - val_psnr_for2d: 33.8653
Epoch 34/1000
 - 39s - loss: 8.2009e-04 - ssim_for2d: 0.9184 - psnr_for2d: 33.8095 - val_loss: 8.4332e-04 - val_ssim_for2d: 0.9181 - val_psnr_for2d: 33.8516
Epoch 35/1000
 - 39s - loss: 8.1739e-04 - ssim_for2d: 0.9186 - psnr_for2d: 33.8342 - val_loss: 8.4062e-04 - val_ssim_for2d: 0.9183 - val_psnr_for2d: 33.8844
Epoch 36/1000
 - 40s - loss: 8.1748e-04 - ssim_for2d: 0.9187 - psnr_for2d: 33.8069 - val_loss: 8.3778e-04 - val_ssim_for2d: 0.9185 - val_psnr_for2d: 33.9271
Epoch 37/1000
 - 43s - loss: 8.1926e-04 - ssim_for2d: 0.9188 - psnr_for2d: 33.7782 - val_loss: 8.3609e-04 - val_ssim_for2d: 0.9187 - val_psnr_for2d: 33.9378
Epoch 38/1000
 - 39s - loss: 8.5169e-04 - ssim_for2d: 0.9188 - psnr_for2d: 33.3139 - val_loss: 8.9568e-04 - val_ssim_for2d: 0.9184 - val_psnr_for2d: 32.9310
Epoch 39/1000
 - 39s - loss: 8.2045e-04 - ssim_for2d: 0.9191 - psnr_for2d: 33.7232 - val_loss: 8.4519e-04 - val_ssim_for2d: 0.9189 - val_psnr_for2d: 33.7352
Epoch 40/1000
 - 40s - loss: 8.2910e-04 - ssim_for2d: 0.9191 - psnr_for2d: 33.5720 - val_loss: 8.7158e-04 - val_ssim_for2d: 0.9190 - val_psnr_for2d: 33.3025
Epoch 00040: early stopping
 
finish prediction
AMOUNT, BATCH, HEIGHT: 3288 32 32
without processed by neural network:
psnr =  33.01512476511432
ssim =  0.9094088004024939
performance after processed by nerual network:
psnr:  33.30548576964172
ssim:  0.9192719894216994
performance of predicted images:
psnr, ssim for raw data: 33.24609813224299 0.9121916197185661
psnr, ssim for predicted result: 33.58131946885795 0.9290177451493784
mae, mse for raw data: 0.016739558613043767 0.0009313933013429778
mae, mse for predicted result 0.016857255639693796 0.0008040131588824199
