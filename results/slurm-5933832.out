+ cd /pylon5/ac5610p/janegao/image-reconstruction-2019/code/code_2d/
+ python main.py
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-31
OMP: Info #156: KMP_AFFINITY: 32 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 2 packages x 16 cores/pkg x 1 threads/core (32 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 17 maps to package 0 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 18 maps to package 0 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 19 maps to package 0 core 7 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 0 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 21 maps to package 0 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 22 maps to package 0 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 0 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 23 maps to package 0 core 15 
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 1 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 24 maps to package 1 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 9 maps to package 1 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 25 maps to package 1 core 3 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 1 core 4 
OMP: Info #171: KMP_AFFINITY: OS proc 26 maps to package 1 core 5 
OMP: Info #171: KMP_AFFINITY: OS proc 11 maps to package 1 core 6 
OMP: Info #171: KMP_AFFINITY: OS proc 27 maps to package 1 core 7 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 1 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 28 maps to package 1 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 13 maps to package 1 core 10 
OMP: Info #171: KMP_AFFINITY: OS proc 29 maps to package 1 core 11 
OMP: Info #171: KMP_AFFINITY: OS proc 14 maps to package 1 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 30 maps to package 1 core 13 
OMP: Info #171: KMP_AFFINITY: OS proc 15 maps to package 1 core 14 
OMP: Info #171: KMP_AFFINITY: OS proc 31 maps to package 1 core 15 
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 7810 thread 0 bound to OS proc set 0
2019-06-28 15:31:23.687599: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-06-28 15:31:23.692247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2095295000 Hz
2019-06-28 15:31:23.692436: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x561e60fa80a0 executing computations on platform Host. Devices:
2019-06-28 15:31:23.692475: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-28 15:31:23.692595: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Using TensorFlow backend.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/janegao/.conda/envs/env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 7973 thread 1 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8812 thread 2 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8814 thread 4 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8813 thread 3 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8815 thread 5 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8816 thread 6 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8817 thread 7 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8818 thread 8 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8820 thread 10 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8819 thread 9 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8821 thread 11 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8822 thread 12 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8823 thread 13 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8824 thread 14 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8825 thread 15 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8826 thread 16 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8827 thread 17 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8828 thread 18 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8829 thread 19 bound to OS proc set 28
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8830 thread 20 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8831 thread 21 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8832 thread 22 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8833 thread 23 bound to OS proc set 29
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8834 thread 24 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8835 thread 25 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8836 thread 26 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8837 thread 27 bound to OS proc set 30
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8838 thread 28 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8839 thread 29 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8840 thread 30 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8841 thread 31 bound to OS proc set 31
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8842 thread 32 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 7972 thread 33 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8843 thread 34 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8844 thread 35 bound to OS proc set 24
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8845 thread 36 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8847 thread 38 bound to OS proc set 17
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8846 thread 37 bound to OS proc set 9
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8848 thread 39 bound to OS proc set 25
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8849 thread 40 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8850 thread 41 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8852 thread 43 bound to OS proc set 26
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8851 thread 42 bound to OS proc set 18
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8853 thread 44 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8854 thread 45 bound to OS proc set 11
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8855 thread 46 bound to OS proc set 19
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8856 thread 47 bound to OS proc set 27
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8857 thread 48 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8858 thread 49 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8859 thread 50 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8860 thread 51 bound to OS proc set 28
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8861 thread 52 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8862 thread 53 bound to OS proc set 13
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8863 thread 54 bound to OS proc set 21
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8864 thread 55 bound to OS proc set 29
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8865 thread 56 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8866 thread 57 bound to OS proc set 14
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8867 thread 58 bound to OS proc set 22
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8868 thread 59 bound to OS proc set 30
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8869 thread 60 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8870 thread 61 bound to OS proc set 15
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8871 thread 62 bound to OS proc set 23
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8873 thread 64 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 7810 tid 8872 thread 63 bound to OS proc set 31
loading the whole csv file (3288, 64, 64, 1)
loading the whole csv file (3288, 64, 64, 1)
shape before reshape (3288, 1, 64, 64)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 64, 64, 64)        5248      
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 64, 32)        2080      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 64, 1)         801       
=================================================================
Total params: 8,129
Trainable params: 8,129
Non-trainable params: 0
_________________________________________________________________
None
Train on 2104 samples, validate on 526 samples
Epoch 1/1000
 - 44s - loss: 0.0193 - ssim_for2d: 0.6766 - psnr_for2d: 19.7119 - val_loss: 0.0049 - val_ssim_for2d: 0.7859 - val_psnr_for2d: 23.8902
Epoch 2/1000
 - 40s - loss: 0.0028 - ssim_for2d: 0.8251 - psnr_for2d: 26.9334 - val_loss: 0.0020 - val_ssim_for2d: 0.8473 - val_psnr_for2d: 28.8469
Epoch 3/1000
 - 40s - loss: 0.0017 - ssim_for2d: 0.8614 - psnr_for2d: 29.7981 - val_loss: 0.0015 - val_ssim_for2d: 0.8711 - val_psnr_for2d: 30.4574
Epoch 4/1000
 - 40s - loss: 0.0014 - ssim_for2d: 0.8793 - psnr_for2d: 30.8555 - val_loss: 0.0013 - val_ssim_for2d: 0.8842 - val_psnr_for2d: 31.2080
Epoch 5/1000
 - 40s - loss: 0.0012 - ssim_for2d: 0.8897 - psnr_for2d: 31.4564 - val_loss: 0.0012 - val_ssim_for2d: 0.8929 - val_psnr_for2d: 31.7238
Epoch 6/1000
 - 40s - loss: 0.0011 - ssim_for2d: 0.8970 - psnr_for2d: 31.8903 - val_loss: 0.0011 - val_ssim_for2d: 0.8990 - val_psnr_for2d: 32.1101
Epoch 7/1000
 - 40s - loss: 0.0010 - ssim_for2d: 0.9020 - psnr_for2d: 32.4007 - val_loss: 0.0011 - val_ssim_for2d: 0.9032 - val_psnr_for2d: 32.5219
Epoch 8/1000
 - 40s - loss: 0.0010 - ssim_for2d: 0.9053 - psnr_for2d: 32.3005 - val_loss: 0.0010 - val_ssim_for2d: 0.9061 - val_psnr_for2d: 32.8616
Epoch 9/1000
 - 40s - loss: 9.8997e-04 - ssim_for2d: 0.9077 - psnr_for2d: 32.5861 - val_loss: 9.8327e-04 - val_ssim_for2d: 0.9080 - val_psnr_for2d: 32.9471
Epoch 10/1000
 - 40s - loss: 9.3840e-04 - ssim_for2d: 0.9093 - psnr_for2d: 33.0517 - val_loss: 9.5645e-04 - val_ssim_for2d: 0.9094 - val_psnr_for2d: 33.1580
Epoch 11/1000
 - 39s - loss: 9.2160e-04 - ssim_for2d: 0.9106 - psnr_for2d: 33.1576 - val_loss: 9.4080e-04 - val_ssim_for2d: 0.9106 - val_psnr_for2d: 33.2629
Epoch 12/1000
 - 40s - loss: 9.0662e-04 - ssim_for2d: 0.9116 - psnr_for2d: 33.2645 - val_loss: 9.2734e-04 - val_ssim_for2d: 0.9116 - val_psnr_for2d: 33.3452
Epoch 13/1000
 - 40s - loss: 8.9677e-04 - ssim_for2d: 0.9125 - psnr_for2d: 33.3090 - val_loss: 9.2412e-04 - val_ssim_for2d: 0.9125 - val_psnr_for2d: 33.2921
Epoch 14/1000
 - 40s - loss: 8.9374e-04 - ssim_for2d: 0.9133 - psnr_for2d: 33.2646 - val_loss: 9.1940e-04 - val_ssim_for2d: 0.9132 - val_psnr_for2d: 33.2675
Epoch 15/1000
 - 40s - loss: 9.5079e-04 - ssim_for2d: 0.9137 - psnr_for2d: 32.6528 - val_loss: 9.0976e-04 - val_ssim_for2d: 0.9139 - val_psnr_for2d: 33.3624
Epoch 16/1000
 - 40s - loss: 8.7466e-04 - ssim_for2d: 0.9144 - psnr_for2d: 33.4265 - val_loss: 8.9072e-04 - val_ssim_for2d: 0.9142 - val_psnr_for2d: 33.5628
Epoch 17/1000
 - 40s - loss: 8.6286e-04 - ssim_for2d: 0.9149 - psnr_for2d: 33.5490 - val_loss: 8.8350e-04 - val_ssim_for2d: 0.9147 - val_psnr_for2d: 33.6247
Epoch 18/1000
 - 40s - loss: 8.6027e-04 - ssim_for2d: 0.9154 - psnr_for2d: 33.5349 - val_loss: 8.7743e-04 - val_ssim_for2d: 0.9152 - val_psnr_for2d: 33.6604
Epoch 19/1000
 - 40s - loss: 8.5194e-04 - ssim_for2d: 0.9158 - psnr_for2d: 33.6099 - val_loss: 8.7293e-04 - val_ssim_for2d: 0.9157 - val_psnr_for2d: 33.6980
Epoch 20/1000
 - 40s - loss: 8.7194e-04 - ssim_for2d: 0.9162 - psnr_for2d: 33.2764 - val_loss: 8.7044e-04 - val_ssim_for2d: 0.9162 - val_psnr_for2d: 33.6922
Epoch 21/1000
 - 41s - loss: 8.4642e-04 - ssim_for2d: 0.9166 - psnr_for2d: 33.6010 - val_loss: 8.6198e-04 - val_ssim_for2d: 0.9164 - val_psnr_for2d: 33.7525
Epoch 22/1000
 - 40s - loss: 8.4327e-04 - ssim_for2d: 0.9170 - psnr_for2d: 33.6102 - val_loss: 8.5851e-04 - val_ssim_for2d: 0.9168 - val_psnr_for2d: 33.7559
Epoch 23/1000
 - 40s - loss: 8.4026e-04 - ssim_for2d: 0.9173 - psnr_for2d: 33.6240 - val_loss: 8.5612e-04 - val_ssim_for2d: 0.9172 - val_psnr_for2d: 33.7834
Epoch 24/1000
 - 40s - loss: 8.5048e-04 - ssim_for2d: 0.9176 - psnr_for2d: 33.4756 - val_loss: 8.5626e-04 - val_ssim_for2d: 0.9175 - val_psnr_for2d: 33.7431
Epoch 25/1000
 - 40s - loss: 8.2937e-04 - ssim_for2d: 0.9179 - psnr_for2d: 33.7301 - val_loss: 8.4602e-04 - val_ssim_for2d: 0.9178 - val_psnr_for2d: 33.8906
Epoch 26/1000
 - 40s - loss: 8.2578e-04 - ssim_for2d: 0.9182 - psnr_for2d: 33.7516 - val_loss: 8.4764e-04 - val_ssim_for2d: 0.9179 - val_psnr_for2d: 33.7564
Epoch 27/1000
 - 40s - loss: 8.2928e-04 - ssim_for2d: 0.9184 - psnr_for2d: 33.6879 - val_loss: 8.6373e-04 - val_ssim_for2d: 0.9180 - val_psnr_for2d: 33.4258
Epoch 28/1000
 - 40s - loss: 8.8841e-04 - ssim_for2d: 0.9185 - psnr_for2d: 33.0058 - val_loss: 8.4614e-04 - val_ssim_for2d: 0.9185 - val_psnr_for2d: 33.7020
Epoch 00028: early stopping
 
finish prediction
AMOUNT, BATCH, HEIGHT: 3288 32 32
without processed by neural network:
psnr =  33.01512476511432
ssim =  0.9094088004024939
performance after processed by nerual network:
psnr:  33.67234917992421
ssim:  0.9187062473804778
performance of predicted images:
psnr, ssim for raw data: 33.24609813224299 0.9121916197185661
psnr, ssim for predicted result: 33.945046058954155 0.9287008301665602
mae, mse for raw data: 0.016739558613043767 0.0009313933013429778
mae, mse for predicted result 0.016056039312151004 0.0007821765099978677
